<div class="container-fluid">
    <div class="row">
        <!-- Sidebar -->
        <div class="col-sm-2 col-md-1 sidebar">
            <h5>Stats</h5>
            <div class="stats m-b-1">
                <span class="label label-{{ vm.statusClassMap[status] }}" ng-repeat="(status, count) in vm.stats">
                        {{ status|uppercase }}: {{ count }}
                </span>
            </div>
            <hr>
            <h5>Diffs</h5>
            <ul class="nav nav-sidebar">
                <li ng-repeat="diff in vm.diffs track by diff._id" ng-class="{active: diff.active}">
                    <a ng-click="vm.getDiff(diff)" href="#">{{ diff.proposalObjectId }}<span ng-show="diff.favorite">*</span></a>
                </li>
            </ul>
            <button type="button" class="btn btn-sm btn-secondary" ng-click="vm.loadMore()">Load More</button>
        </div><!-- /.sidebar -->

        <!-- Page Content -->
        <div class="col-sm-10 col-sm-offset-2 col-md-11 col-md-offset-1 main">
            <h1 class="page-header">Tracker</h1>

            <!--<button type="button" class="btn btn-sm btn-secondary" ng-click="vm.reload()">-->
                <!--<i class="fa fa-refresh"></i>-->
            <!--</button>-->

            <!--<button type="button" class="btn btn-sm btn-info" ng-click="vm.reindex()">Re-Index Tracker Data</button>-->
            <h3 ng-show="vm.loading">Loading ...</h3>
            <!--<div ng-show="vm.reindexing">-->
                <!--<h3>Re-Indexing ... may take a bit...</h3>-->
                <!--<progress class="progress progress-striped progress-animated" max="100" value="{{vm.progressValue}}">{{ vm.progressValue }}%</progress>-->
            <!--</div>-->

            <div ng-show="vm.error">
                ERRORS
                {{ vm.errorDescription }}
            </div>

            <div
                    class="card"
                    ng-class="{'card-info': vm.currentDiff.status == 'changed', 'card-danger': vm.currentDiff.status == 'denied' }"
            >
                <div class="card-header">
                    <div class="row">
                        <div class="col-md-3">
                            ID: {{ vm.currentDiff.proposalObjectId }} ({{ vm.currentDiff.entityId }})
                            <a href="#" class="label" ng-class="{'label-primary': !vm.currentDiff.favorite, 'label-danger': vm.currentDiff.favorite}" ng-click="vm.setFavorite(vm.currentDiff, vm.currentDiff.favorite ? false : true)">
                                {{ vm.currentDiff.favorite ? 'Remove from Favorites' : 'Add to Favorites' }}
                            </a>
                        </div>
                        <div class="col-md-2">
                            Status:
                            <span class="label label-{{ vm.statusClassMap[vm.currentDiff.status ? vm.currentDiff.status : 'none'] }}">
                                {{(vm.currentDiff.status ? vm.currentDiff.status : 'none')|uppercase }}
                            </span>
                        </div>
                        <div class="col-md-2" ng-show="vm.currentDiff.prevStatus && vm.currentDiff.prevStatus != 'none'">
                            Previous Status:
                            <span class="label label-{{ vm.statusClassMap[vm.currentDiff.prevStatus ? vm.currentDiff.prevStatus : 'none'] }}">
                                {{ vm.currentDiff.prevStatus|uppercase }}
                            </span>
                        </div>
                    </div>
                    <div class="row p-t-1">
                        <div class="col-md-12">
                            <status-controls diff="vm.currentDiff" set-status-handler="vm.setStatus(diff, status)"></status-controls>
                        </div>

                    </div>
                </div>
                <div class="card-block">
                    <div ng-bind-html="vm.trustHtml(vm.currentDiff.diffContent)"></div>
                </div>
                <div class="card-block" ng-if="!vm.currentDiff.hideSource">
                    <hr>
                    <div class="row">
                        <div class="col-md-6" ng-bind-html="vm.trustHtml(vm.currentDiff.oldContent)"></div>
                        <div class="col-md-6" ng-bind-html="vm.trustHtml(vm.currentDiff.newContent)"></div>
                    </div>
                </div>

                <div class="card-footer">
                    <status-controls diff="vm.currentDiff" set-status-handler="vm.setStatus(diff, status)"></status-controls>
                </div>
            </div><!-- end of card -->
        </div>
    </div>
</div>
